<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Asynchronous programming in ASP.NET web stack!" /><meta property="og:locale" content="en" /><meta name="description" content="How to apply TPM (async/await) in various components of ASP.NET" /><meta property="og:description" content="How to apply TPM (async/await) in various components of ASP.NET" /><link rel="canonical" href="https://fiseni.com/posts/asynchronous-programming-in-aspnet-web-stack/" /><meta property="og:url" content="https://fiseni.com/posts/asynchronous-programming-in-aspnet-web-stack/" /><meta property="og:site_name" content="Fati Iseni - Blog" /><meta property="og:image" content="https://fiseni.com/assets/img/posts/896547/cover.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-05-16T13:00:00+02:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://fiseni.com/assets/img/posts/896547/cover.png" /><meta property="twitter:title" content="Asynchronous programming in ASP.NET web stack!" /><meta name="twitter:site" content="@fiseni" /><meta name="google-site-verification" content="p9Rvv10SRN6FJ9f7Vbg7Pnrts_Y9_nDh4zVdFcfx7Ls" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-05-16T13:00:00+02:00","datePublished":"2023-05-16T13:00:00+02:00","description":"How to apply TPM (async/await) in various components of ASP.NET","headline":"Asynchronous programming in ASP.NET web stack!","image":"https://fiseni.com/assets/img/posts/896547/cover.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://fiseni.com/posts/asynchronous-programming-in-aspnet-web-stack/"},"url":"https://fiseni.com/posts/asynchronous-programming-in-aspnet-web-stack/"}</script><title>Asynchronous programming in ASP.NET web stack! | Fati Iseni - Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Fati Iseni - Blog"><meta name="application-name" content="Fati Iseni - Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.29.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { let self = this;this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { self.clearMode(); } self.notify(); }); if (!this.hasMode) { return; } if (this.isDarkMode) { this.setDark(); } else { this.setLight(); } } get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isPreferDark() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }get modeStatus() { if (this.hasMode) { return this.mode; } else { return this.isPreferDark ? ModeToggle.DARK_MODE : ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); }notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { this.clearMode(); } else { if (this.isPreferDark) { this.setLight(); } else { this.setDark(); } } this.notify(); } } const modeToggle = new ModeToggle(); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/fati-iseni.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/">Fati Iseni - Blog</a></h1><p class="site-subtitle fst-italic mb-0">Software Architect</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/fiseni" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/fiseni" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['fati.iseni','pozitrongroup.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Asynchronous programming in ASP.NET web stack!</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>Asynchronous programming in ASP.NET web stack!</h1><div class="post-meta text-muted"><div class="mt-3 mb-3"> <a href="/assets/img/posts/896547/cover.png" class="popup img-link preview-img shimmer"><img src="/assets/img/posts/896547/cover.png" alt="Preview Image" width="1200" height="630" loading="lazy"></a></div><div class="d-flex justify-content-between"><div> <span> Posted <time data-ts="1684234800" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > May 16, 2023 </time> </span></div><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1263 words" > <em>7 min</em> read</span></div></div></div></header><div class="content"><p>In .NET we have three patterns for asynchronous operations, Asynchronous Programming Model (APM), Event-based Asynchronous Pattern (EAP) and Task-based Asynchronous Pattern (TAP). Nowadays, the TAP is ubiquitous and the recommended asynchronous pattern. The TAP model greatly simplifies the asynchronous calls with async/await, and that’s the way to go.</p><p>Unfortunately, that’s not the case for some of the older platforms and frameworks. Since the TAP was not yet introduced at that time, there was no native support for it. Instead, there are some well-defined “workarounds” on how to make use of the async/await pattern in the older ASP.NET web applications. In this article, I’ll go through various components of ASP.NET 4.8 and describe how to use asynchronous code in them.</p><h2 id="aspnet-mvcwebapi"><span class="me-2">ASP.NET MVC/WebApi</span><a href="#aspnet-mvcwebapi" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>These are fairly new frameworks and there is native support for async/await. You don’t need to apply any special workaround.</p><h2 id="aspnet-webforms-aspx"><span class="me-2">ASP.NET WebForms (aspx)</span><a href="#aspnet-webforms-aspx" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Let’s say we have the following handler in a given aspx page.</p><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="k">protected</span> <span class="k">void</span> <span class="nf">Button1_Click</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// Some logic</span>
    <span class="kt">var</span> <span class="n">customer</span> <span class="p">=</span> <span class="n">_customerService</span><span class="p">.</span><span class="nf">GetCustomer</span><span class="p">(</span><span class="m">1</span><span class="p">);</span>
    <span class="n">TextBox1</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="n">customer</span><span class="p">.</span><span class="n">Name</span><span class="p">;</span>
    <span class="c1">// Some other logic</span>
<span class="p">}</span>
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">CustomerService</code> also exposes an async method <code class="language-plaintext highlighter-rouge">GetCustomerAsync</code>, and we would like to utilize it in our handler. We need to apply the following changes:</p><ul><li>Open the markup of the page and add the <code class="language-plaintext highlighter-rouge">Async="true"</code> directive. It would be something as shown below.<div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="p">&lt;%</span><span class="err">@</span> <span class="n">Page</span> <span class="n">Async</span><span class="p">=</span><span class="s">"true"</span> <span class="n">Title</span><span class="p">=</span><span class="s">"Home Page"</span> <span class="n">Language</span><span class="p">=</span><span class="s">"C#"</span> <span class="n">MasterPageFile</span><span class="p">=</span><span class="s">"~/Site.Master"</span> <span class="n">AutoEventWireup</span><span class="p">=</span><span class="s">"true"</span> <span class="n">CodeBehind</span><span class="p">=</span><span class="s">"Default.aspx.cs"</span> <span class="n">Inherits</span><span class="p">=</span><span class="s">"DemoApp.WebForms._Default"</span> <span class="p">%&gt;</span>
</pre></table></code></div></div><li>Create a new method with <code class="language-plaintext highlighter-rouge">async Task</code> signature and copy the whole content of the handler into it. You may adopt a convention where you’ll name these methods the same as the handlers, and then just add the <code class="language-plaintext highlighter-rouge">Async</code> suffix.<li>In the original handler, you’ll use <code class="language-plaintext highlighter-rouge">RegisterAsyncTask</code> to register the newly created method for asynchronous execution.</ul><p>We’ll end up with the following code. This is all we need to do, so we can make async calls from our pages.</p><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="k">protected</span> <span class="k">void</span> <span class="nf">Button1_Click</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nf">RegisterAsyncTask</span><span class="p">(</span><span class="k">new</span> <span class="nf">PageAsyncTask</span><span class="p">(</span><span class="n">Button1_ClickAsync</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">protected</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Button1_ClickAsync</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// Some logic</span>
    <span class="kt">var</span> <span class="n">customer</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_customerService</span><span class="p">.</span><span class="nf">GetCustomerAsync</span><span class="p">(</span><span class="m">1</span><span class="p">);</span>
    <span class="n">TextBox1</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="n">customer</span><span class="p">.</span><span class="n">Name</span><span class="p">;</span>
    <span class="c1">// Some other logic</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="what-not-to-do"><span class="me-2">What not to do</span><a href="#what-not-to-do" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Do not use <code class="language-plaintext highlighter-rouge">async void</code> for the handlers. In some platforms like WinForms/WPF we don’t have a choice, but for WebForms pages we have a better solution. So, try to adopt the above solution.<li>Do not partially extract the content of the handlers to the new async method. We have to understand that with <code class="language-plaintext highlighter-rouge">RegisterAsyncTask</code> we’re just registering the action for asynchronous execution, but the handler is still a void method, and it won’t wait for the execution to complete. So, any code that you have after <code class="language-plaintext highlighter-rouge">RegisterAsyncTask</code> will be executed immediately. Avoid adding any code after it, unless you’re completely sure that it is not dependent on the results or side effects of the async method.</ul><h2 id="aspnet-httphandlers-ashx"><span class="me-2">ASP.NET HttpHandlers (ashx)</span><a href="#aspnet-httphandlers-ashx" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>If you have a lot of HTTP handlers in the solution, you might need to execute async methods in them. Luckily, it’s quite easy to do that for HTTP handlers. All we need is to inherit from <code class="language-plaintext highlighter-rouge">HttpTaskAsyncHandler</code> abstract base class. Let’s say we have the following handler.</p><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">CustomerHandler</span> <span class="p">:</span> <span class="n">IHttpHandler</span>
<span class="p">{</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">ProcessRequest</span><span class="p">(</span><span class="n">HttpContext</span> <span class="n">context</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">customerService</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">CustomerService</span><span class="p">();</span>
        <span class="kt">var</span> <span class="n">customer</span> <span class="p">=</span> <span class="n">customerService</span><span class="p">.</span><span class="nf">GetCustomer</span><span class="p">(</span><span class="m">1</span><span class="p">);</span>
        <span class="n">context</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="n">ContentType</span> <span class="p">=</span> <span class="s">"text/plain"</span><span class="p">;</span>
        <span class="n">context</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="n">customer</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="kt">bool</span> <span class="n">IsReusable</span>
    <span class="p">{</span>
        <span class="k">get</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>If we want to utilize the <code class="language-plaintext highlighter-rouge">GetCustomerAsync</code> method, we’ll update the handler as follows:</p><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">CustomerHandler</span> <span class="p">:</span> <span class="n">HttpTaskAsyncHandler</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">override</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">ProcessRequestAsync</span><span class="p">(</span><span class="n">HttpContext</span> <span class="n">context</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">customerService</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">CustomerService</span><span class="p">();</span>
        <span class="kt">var</span> <span class="n">customer</span> <span class="p">=</span> <span class="k">await</span> <span class="n">customerService</span><span class="p">.</span><span class="nf">GetCustomerAsync</span><span class="p">(</span><span class="m">1</span><span class="p">);</span>
        <span class="n">context</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="n">ContentType</span> <span class="p">=</span> <span class="s">"text/plain"</span><span class="p">;</span>
        <span class="n">context</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="n">customer</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="aspnet-web-services-asmx"><span class="me-2">ASP.NET Web Services (asmx)</span><a href="#aspnet-web-services-asmx" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This is the trickiest one. The web services (asmx) don’t have support for the TAP model (async/await), but they do have support for APM. The APM was the first asynchronous model introduced in <code class="language-plaintext highlighter-rouge">.NET Framework 1.0</code>. In this pattern, asynchronous operations require Begin and End methods (for example, BeginSomething and EndSomething to implement an asynchronous operation). It’s a legacy model and no longer recommended. We can write a TAP to APM interop extensions, so we can consume the Task-based methods from our web services.</p><p>Let’s say we have the following web service.</p><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">CustomerWebService</span> <span class="p">:</span> <span class="n">System</span><span class="p">.</span><span class="n">Web</span><span class="p">.</span><span class="n">Services</span><span class="p">.</span><span class="n">WebService</span>
<span class="p">{</span>
    <span class="p">[</span><span class="n">WebMethod</span><span class="p">]</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="nf">GetCustomerName</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">customerService</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">CustomerService</span><span class="p">();</span>
        <span class="kt">var</span> <span class="n">customerName</span> <span class="p">=</span> <span class="n">customerService</span><span class="p">.</span><span class="nf">GetCustomerName</span><span class="p">(</span><span class="n">id</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">customerName</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>If we want to utilize the async methods in <code class="language-plaintext highlighter-rouge">CustomerService</code>, we’ll have to make the following changes.</p><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">CustomerWebService</span> <span class="p">:</span> <span class="n">System</span><span class="p">.</span><span class="n">Web</span><span class="p">.</span><span class="n">Services</span><span class="p">.</span><span class="n">WebService</span>
<span class="p">{</span>
    <span class="p">[</span><span class="n">WebMethod</span><span class="p">]</span>
    <span class="k">public</span> <span class="n">IAsyncResult</span> <span class="nf">BeginGetCustomerName</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">,</span> <span class="n">AsyncCallback</span> <span class="n">callback</span><span class="p">,</span> <span class="kt">object</span> <span class="n">state</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">customerService</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">CustomerService</span><span class="p">();</span>
        <span class="k">return</span> <span class="n">customerService</span><span class="p">.</span><span class="nf">GetCustomerNameAsync</span><span class="p">(</span><span class="n">id</span><span class="p">).</span><span class="nf">AsApm</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">state</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="p">[</span><span class="n">WebMethod</span><span class="p">]</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="nf">EndGetCustomerName</span><span class="p">(</span><span class="n">IAsyncResult</span> <span class="n">result</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">result</span><span class="p">.</span><span class="n">Unwrap</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>The APM interop implementation is as follows.</p><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
</pre><td class="rouge-code"><pre><span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">ApmInteropExtensions</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="n">IAsyncResult</span> <span class="nf">AsApm</span><span class="p">(</span><span class="k">this</span> <span class="n">Task</span> <span class="n">task</span><span class="p">,</span> <span class="n">AsyncCallback</span> <span class="n">callback</span><span class="p">,</span> <span class="kt">object</span> <span class="n">state</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">task</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentNullException</span><span class="p">(</span><span class="k">nameof</span><span class="p">(</span><span class="n">task</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="kt">var</span> <span class="n">tcs</span> <span class="p">=</span> <span class="k">new</span> <span class="n">TaskCompletionSource</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;(</span><span class="n">state</span><span class="p">);</span>

        <span class="n">task</span><span class="p">.</span><span class="nf">ContinueWith</span><span class="p">(</span><span class="n">t</span> <span class="p">=&gt;</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">IsFaulted</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">tcs</span><span class="p">.</span><span class="nf">TrySetException</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">Exception</span><span class="p">.</span><span class="n">InnerExceptions</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">IsCanceled</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">tcs</span><span class="p">.</span><span class="nf">TrySetCanceled</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="n">tcs</span><span class="p">.</span><span class="nf">TrySetResult</span><span class="p">(</span><span class="k">null</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">callback</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="nf">callback</span><span class="p">(</span><span class="n">tcs</span><span class="p">.</span><span class="n">Task</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span> <span class="n">TaskScheduler</span><span class="p">.</span><span class="n">Default</span><span class="p">);</span>

        <span class="k">return</span> <span class="n">tcs</span><span class="p">.</span><span class="n">Task</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">IAsyncResult</span> <span class="n">AsApm</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">this</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">task</span><span class="p">,</span> <span class="n">AsyncCallback</span> <span class="n">callback</span><span class="p">,</span> <span class="kt">object</span> <span class="n">state</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">task</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentNullException</span><span class="p">(</span><span class="k">nameof</span><span class="p">(</span><span class="n">task</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="kt">var</span> <span class="n">tcs</span> <span class="p">=</span> <span class="k">new</span> <span class="n">TaskCompletionSource</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">state</span><span class="p">);</span>

        <span class="n">task</span><span class="p">.</span><span class="nf">ContinueWith</span><span class="p">(</span><span class="n">t</span> <span class="p">=&gt;</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">IsFaulted</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">tcs</span><span class="p">.</span><span class="nf">TrySetException</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">Exception</span><span class="p">.</span><span class="n">InnerExceptions</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">IsCanceled</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">tcs</span><span class="p">.</span><span class="nf">TrySetCanceled</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="n">tcs</span><span class="p">.</span><span class="nf">TrySetResult</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">Result</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">callback</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="nf">callback</span><span class="p">(</span><span class="n">tcs</span><span class="p">.</span><span class="n">Task</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span> <span class="n">TaskScheduler</span><span class="p">.</span><span class="n">Default</span><span class="p">);</span>

        <span class="k">return</span> <span class="n">tcs</span><span class="p">.</span><span class="n">Task</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Unwrap</span><span class="p">(</span><span class="k">this</span> <span class="n">IAsyncResult</span> <span class="n">asyncResult</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">asyncResult</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentNullException</span><span class="p">(</span><span class="k">nameof</span><span class="p">(</span><span class="n">asyncResult</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">asyncResult</span> <span class="k">is</span> <span class="n">Task</span> <span class="n">task</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">task</span><span class="p">.</span><span class="nf">GetAwaiter</span><span class="p">().</span><span class="nf">GetResult</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentException</span><span class="p">(</span><span class="s">"Invalid asyncResult"</span><span class="p">,</span> <span class="k">nameof</span><span class="p">(</span><span class="n">asyncResult</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">T</span> <span class="n">Unwrap</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">this</span> <span class="n">IAsyncResult</span> <span class="n">asyncResult</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">asyncResult</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentNullException</span><span class="p">(</span><span class="k">nameof</span><span class="p">(</span><span class="n">asyncResult</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">asyncResult</span> <span class="k">is</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">task</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">task</span><span class="p">.</span><span class="nf">GetAwaiter</span><span class="p">().</span><span class="nf">GetResult</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentException</span><span class="p">(</span><span class="s">"Invalid asyncResult"</span><span class="p">,</span> <span class="k">nameof</span><span class="p">(</span><span class="n">asyncResult</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Let’s summarize what we have done here:</p><ul><li>For a given web method, we have created two methods with the same name. Added <code class="language-plaintext highlighter-rouge">Begin</code> and <code class="language-plaintext highlighter-rouge">End</code> prefixes to the name of the methods.<li>The <code class="language-plaintext highlighter-rouge">Begin</code> method will accept the original input parameters, and additionally the <code class="language-plaintext highlighter-rouge">AsyncCallBack</code> and <code class="language-plaintext highlighter-rouge">state</code> (these will be provided by the framework). It returns <code class="language-plaintext highlighter-rouge">IAsyncResult</code>.<li>The <code class="language-plaintext highlighter-rouge">End</code> method will accept <code class="language-plaintext highlighter-rouge">IAsyncResult</code> (provided by the framework) and will return the original output.</ul><p>Note: The <code class="language-plaintext highlighter-rouge">EndGetCustomerName</code> won’t run on the original thread and it won’t have access to the original context. It means you won’t have access to <code class="language-plaintext highlighter-rouge">HttpContext.Current</code>. Bear that in mind and avoid some complex logic in <code class="language-plaintext highlighter-rouge">End</code> methods. Its job is to just extract and return the result.</p><p>I hope you found the article useful and happy coding!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/software-development/">Software Development</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/dotnet/" class="post-tag no-text-decoration" >dotnet</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Asynchronous%20programming%20in%20ASP.NET%20web%20stack!%20-%20Fati%20Iseni%20-%20Blog&url=https%3A%2F%2Ffiseni.com%2Fposts%2Fasynchronous-programming-in-aspnet-web-stack%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Asynchronous%20programming%20in%20ASP.NET%20web%20stack!%20-%20Fati%20Iseni%20-%20Blog&u=https%3A%2F%2Ffiseni.com%2Fposts%2Fasynchronous-programming-in-aspnet-web-stack%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Ffiseni.com%2Fposts%2Fasynchronous-programming-in-aspnet-web-stack%2F&text=Asynchronous%20programming%20in%20ASP.NET%20web%20stack!%20-%20Fati%20Iseni%20-%20Blog" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/publishing-strategies-in-MediatR/">Publishing strategies in MediatR</a><li class="text-truncate lh-lg"> <a href="/posts/mediatr-publishing-strategies/">Extending MediatR with publishing strategies</a><li class="text-truncate lh-lg"> <a href="/posts/the-journey-to-630x-faster-batch-job/">From Hours to Seconds: The Journey to a 630x Faster Batch Job</a><li class="text-truncate lh-lg"> <a href="/posts/soft-delete/">Global soft delete in EF Core!</a><li class="text-truncate lh-lg"> <a href="/posts/current-user-aspnetcore/">Current user implementation in ASP.NET Core!</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/efcore/">EFCore</a> <a class="post-tag btn btn-outline-primary" href="/tags/design-patterns/">design patterns</a> <a class="post-tag btn btn-outline-primary" href="/tags/dotnetcore/">dotnetcore</a> <a class="post-tag btn btn-outline-primary" href="/tags/software-architecture/">software architecture</a> <a class="post-tag btn btn-outline-primary" href="/tags/ddd/">ddd</a> <a class="post-tag btn btn-outline-primary" href="/tags/dotnet/">dotnet</a> <a class="post-tag btn btn-outline-primary" href="/tags/mediator/">Mediator</a> <a class="post-tag btn btn-outline-primary" href="/tags/productivity/">Productivity</a> <a class="post-tag btn btn-outline-primary" href="/tags/auditing/">Auditing</a> <a class="post-tag btn btn-outline-primary" href="/tags/azure/">azure</a></div></section></div><section id="toc-wrapper" class="d-none ps-0 pe-4"><h2 class="panel-heading ps-3 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/the-journey-to-630x-faster-batch-job/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1706439600" data-df="ll" > Jan 28, 2024 </time><h4 class="pt-0 my-2">From Hours to Seconds: The Journey to a 630x Faster Batch Job</h4><div class="text-muted"><p>How we optimized a batch job to perform 630x faster.</p></div></div></a></article><article class="col"> <a href="/posts/customizing-column-naming-conventions-for-owned-types-in-ef-core/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1665658800" data-df="ll" > Oct 13, 2022 </time><h4 class="pt-0 my-2">Customizing Column Naming Conventions for Owned Types in EF Core</h4><div class="text-muted"><p>Learn how to customize column naming conventions for owned types in EF Core.</p></div></div></a></article><article class="col"> <a href="/posts/install-wkhtmltopdf-for-azure-linux-app-service-plans/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1663498800" data-df="ll" > Sep 18, 2022 </time><h4 class="pt-0 my-2">Install wkhtmltopdf for Azure Linux App Service Plans</h4><div class="text-muted"><p>Learn how to install the wkhtmltopdf package on Azure Linux App Service Plans during app startup, enabling HTML-to-PDF and HTML-to-image conversion features for your web applications running on Lin...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/simplifying-configuration-for-temporal-tables-in-EF-Core/" class="btn btn-outline-primary" aria-label="Older" ><p>Simplifying Configuration for Temporal Tables in EF Core!</p></a> <a href="/posts/current-user-aspnetcore/" class="btn btn-outline-primary" aria-label="Newer" ><p>Current user implementation in ASP.NET Core!</p></a></nav><div id="disqus_thread"><p class="text-center text-muted small">Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://fiseni.com/posts/asynchronous-programming-in-aspnet-web-stack/'; this.page.identifier = '/posts/asynchronous-programming-in-aspnet-web-stack/'; };var disqus_observer = new IntersectionObserver( function (entries) { if (entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://fiseni.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] } ); disqus_observer.observe(document.getElementById('disqus_thread'));function reloadDisqus() { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) {if (typeof DISQUS === 'undefined') { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } } if (document.getElementById('mode-toggle')) { window.addEventListener('message', reloadDisqus); } </script><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2024</time> <a href="https://twitter.com/fiseni">Fati Iseni</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.1.1" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/efcore/">EFCore</a> <a class="post-tag btn btn-outline-primary" href="/tags/design-patterns/">design patterns</a> <a class="post-tag btn btn-outline-primary" href="/tags/dotnetcore/">dotnetcore</a> <a class="post-tag btn btn-outline-primary" href="/tags/software-architecture/">software architecture</a> <a class="post-tag btn btn-outline-primary" href="/tags/ddd/">ddd</a> <a class="post-tag btn btn-outline-primary" href="/tags/dotnet/">dotnet</a> <a class="post-tag btn btn-outline-primary" href="/tags/mediator/">Mediator</a> <a class="post-tag btn btn-outline-primary" href="/tags/productivity/">Productivity</a> <a class="post-tag btn btn-outline-primary" href="/tags/auditing/">Auditing</a> <a class="post-tag btn btn-outline-primary" href="/tags/azure/">azure</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.29.0/dist/tocbot.min.js"></script> <script src="/assets/js/dist/post.min.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6N7H7NRJZ7"></script> <script> document.addEventListener('DOMContentLoaded', function (event) { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-6N7H7NRJZ7'); }); </script> <script>SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
